<!DOCTYPE html>
<html>
<body>

<button onclick="makeBill()">Download Bill</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCgaZ9DqGuszvycCRuJceNvg7G86OTc9oU",
  authDomain: "restaurant-55333.firebaseapp.com",
  projectId: "restaurant-55333"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const orderId = new URLSearchParams(window.location.search).get("orderId");

window.makeBill = async () => {
  const snap = await getDoc(doc(db, "orders", orderId));
  const o = snap.data();

  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();

  pdf.text("Restaurant Bill", 20, 20);
  pdf.text(`Name: ${o.customerName}`, 20, 30);
  pdf.text(`Table: ${o.tableNumber}`, 20, 40);

  let y = 50;
  let total = 0;
  o.items.forEach(i => {
    pdf.text(`${i.name} - ₹${i.price}`, 20, y);
    total += i.price;
    y += 10;
  });

  pdf.text(`Total: ₹${total}`, 20, y + 10);
  pdf.save("bill.pdf");
};
</script>
</body>
</html>
