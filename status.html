<!DOCTYPE html>
<html>
<body>

<h2>Order Status</h2>
<div id="status"></div>
<button id="billBtn" disabled onclick="goBill()">Download Bill</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCgaZ9DqGuszvycCRuJceNvg7G86OTc9oU",
  authDomain: "restaurant-55333.firebaseapp.com",
  projectId: "restaurant-55333"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const params = new URLSearchParams(window.location.search);
const orderId = params.get("orderId");

onSnapshot(doc(db, "orders", orderId), snap => {
  const o = snap.data();
  document.getElementById("status").innerHTML = `
    Status: ${o.status}<br>
    Ready Time: ${o.readyTime ?? "-"} min
  `;
  if (o.status === "ready") {
    document.getElementById("billBtn").disabled = false;
  }
});

window.goBill = () => {
  window.location.href = `bill.html?orderId=${orderId}`;
};
</script>
</body>
</html>
